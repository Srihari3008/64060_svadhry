---
title: "FML Assignment 3"
output: html_document
date: "2023-11-11"
---

```{r}

library(ggplot2)
library(factoextra)
library(flexclust)
library(cluster)
library(tidyverse)
library(dplyr)

```

#   1.Use only the numerical variables (1 to 9) to cluster the 21 firms. Justify the various choices made in conducting the cluster analysis, such as weights for different variables, the specific clustering algorithm(s) used, the number of clusters formed, and so on.

```{r}

ps <- read.csv("C:/Users/sriha/Desktop/Assignments/Fundamentals of Machine Learning/Datasets/Pharmaceuticals.csv")

pharmaceuticals <- na.omit(ps)

pharmaceuticals

```


# Considering Quantitative data
```{r}
row.names(pharmaceuticals)<- pharmaceuticals[,1]

pharma <- pharmaceuticals[,3:11]

t(t(names(pharma)))

head(pharma)

```

# Normalising the Data

```{r}

pharma1<-scale(pharma)

head(pharma1)


```

# Elbow method for determining number of clusters

```{r}

fviz_nbclust(pharma1, kmeans, method = "wss")

# From the graph we cannot determine K value, Hence using silhoutte method

```
#Silhouette method for determining number of clusters

```{r}

fviz_nbclust(pharma1, kmeans, method = "silhouette")



```


# K means clustrering

```{r}
set.seed(150)

k5 <- kmeans(pharma1, centers = 5, nstart = 25)

#Visualize the output

k5$centers  #centroids

```


```{r}
#  Visualizing the clusters

fviz_cluster(k5,data = pharma1) 


```

```{r}

print(k5)

```

```{r}

dis <- dist(pharma1, method = "euclidean")

fviz_dist(dis)


```


```{r}

# From thhe data the center is defined after 25 restarts and there are 5 clusters. 

fit <- kmeans(pharma1,5)

```

```{r}

#Finding the mean value of variables

aggregate(pharma1,by=list(fit$cluster),FUN=mean)


```

```{r}

# Cluster Plot

clusplot(pharma1,fit$cluster,color =
           TRUE,shade = TRUE,labels = 2,lines = 0)


```

## 2 Interpret the clusters with respect to the numerical variables used in forming the clusters. Is there a pattern in the clusters with respect to the numerical variables?

```{r}
#Cluster 1 - AHM,SGP,WYE,BMY,AZN, ABT, NVS, LLY ( lowest Market_Cap,lowest Beta,lowest PE_Ratio,highest Leverage,highest Rev_Growth.)

#Cluster 2 - BAY, CHTT, IVX (lowest Rev_Growth,highest Beta and levearge,lowest Net_Profit_Margin)

#Cluster 3 - WPI, MRX,ELN,AVE (lowest PE_Ratio,highest ROE,lowest ROA,lowest Net_Profit_Margin, highest Rev_Growth)

#Cluster 4 - AGN, PHA (lowest Beta,lowest Asset_Turnover, Highest PE Ratio)

#Cluster 5 - JNJ, MRK, PFE,GSK (Highest Market_Cap,ROE, ROA,Asset_Turnover Ratio and lowest Beta/PE Ratio)

Pharma_Cluster <- pharma1[,c(12,13,14)]%>% mutate(clusters = k5$cluster)%>% arrange(clusters, ascending = TRUE)
Pharma_Cluster


```

```{r}
# 3.Provide an appropriate name for each cluster using any or all of the variables in the dataset.

# Cluster 1: Top Buying 

# Cluster 2: Significant Risk 

# Cluster 3: Attempt it 

# Cluster 4: Very Dangerous or Runaway 

# Cluster 5: A Perfect Asset


```



